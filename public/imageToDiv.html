<!DOCTYPE html>
<html lang="en-US">

<head>

</head>

<body>
  <canvas id="canvas1" width="200" height="200" style="position: absolute; right: 0; top: 0;"></canvas>
  <script src="https://www.marvinj.org/releases/marvinj-0.7.js"></script>
  <script>
    image = new MarvinImage();
   /*
    * Image upload code came from this source:
    * https://stackoverflow.com/questions/22087076/how-to-make-a-simple-image-upload-using-javascript-html
    */
    window.addEventListener('load', function () {
      document.querySelector('input[type="file"]').addEventListener('change', function () {
        if (this.files && this.files[0]) {
          var img = document.querySelector('img');
          img.onload = () => {
            URL.revokeObjectURL(img.src);
          }

          img.src = URL.createObjectURL(this.files[0]); 
          image.load(img.src, imageLoaded);
        }
      });
    });



    function imageLoaded() {
      var gridContainer = document.createElement('div');
      gridContainer.id = "gridContainer";
      gridContainer.style.cssText = `width:${image.getWidth()}; height:${image.getHeight()}; display: grid; grid-template-columns: repeat(${image.getWidth()}, 1px);`;
      document.body.appendChild(gridContainer);
      for (var y = 0; y < image.getHeight(); y++) {
        for (var x = 0; x < image.getWidth(); x++) {
          var elemDiv = document.createElement('div');
          elemDiv.style.cssText = `display: inline-block;background-color:rgb(${image.getIntComponent0(x, y)},${image.getIntComponent1(x, y)},${image.getIntComponent2(x, y)});width: 1px;height: 1px;`;
          document.getElementById('gridContainer').appendChild(elemDiv);
        }

      }
      document.getElementById('code').textContent = document.getElementById('gridContainer').outerHTML;
    }

  </script>
  <h1>Image to Divs</h1>
  
  <input type='file' />
  <h2>Uploaded File</h2>
  <img id="myImg" src="#" alt="Your uploaded file will appear here.">
  <h2>Code Result</h2>
  <pre id="code" style="width: 100%; height: 40px; overflow-x: scroll;"></pre>
  <h2>Image Converted to Divs</h2>
</body>

</html>